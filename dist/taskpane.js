/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={18774:function(t,e,n){t.exports=n.p+"assets/folder.png"},58394:function(t,e,n){t.exports=n.p+"02b0da5b358a8753de4f.css"},98362:function(t,e,n){t.exports=n.p+"assets/logo-filled.png"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){if(null!=e){var n=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(t(e)+" is not iterable")}function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function o(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function c(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return a(l,"_invoke",function(n,r,o){var a,i,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,i=0,c=t,p.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,m=a[2];n>3?(o=m===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,p.v=r,p.n=a[1]):d<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,p.n=m,i=0))}if(o||n>1)return s;throw f=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),i=l,c=m;(e=i<2?t:c)||!f;){a||(i?i<3?(i>1&&(p.n=-1),d(i,c)):p.n=c:p.v=c);try{if(u=2,a){if(i||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==s)break}catch(e){a=t,i=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,i),!0),l}var s={};function u(){}function l(){}function f(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(a(e={},r,function(){return this}),e),d=f.prototype=u.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,a(d,"constructor",f),a(f,"constructor",l),l.displayName="GeneratorFunction",a(f,i,"GeneratorFunction"),a(d),a(d,i,"Generator"),a(d,r,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:m}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){function i(e,n){a(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},a(t,e,n,r)}function i(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function c(t){i(a,r,o,c,s,"next",t)}function s(t){i(a,r,o,c,s,"throw",t)}c(void 0)})}}function s(t){var e=document.getElementById("message-box");e&&(e.textContent=t,e.style.display="block",setTimeout(function(){e.style.opacity="1",e.style.transition="opacity 0.8s",e.style.opacity="0",setTimeout(function(){e.style.display="none",e.style.opacity="1"},800)},3e3))}function u(t){return new Promise(function(e){var n=document.getElementById(t);if(n)return e(n);var r=new MutationObserver(function(){var n=document.getElementById(t);n&&(r.disconnect(),e(n))});r.observe(document.body,{childList:!0,subtree:!0})})}function l(t){return f.apply(this,arguments)}function f(){return(f=c(o().m(function t(e){return o().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,n){e.body.getAsync("text",function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):n(e.error)})}))},t)}))).apply(this,arguments)}function p(t){return d.apply(this,arguments)}function d(){return(d=c(o().m(function t(r){var a,i,c,s,u;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r.attachments&&0!==r.attachments.length){t.n=1;break}return t.a(2,[]);case 1:a=[],i=n(r.attachments),t.p=2,s=o().m(function t(){var e,n,i,s;return o().w(function(t){for(;;)switch(t.n){case 0:return e=c.value,t.n=1,new Promise(function(t,n){r.getAttachmentContentAsync(e.id,function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):n(e.error)})});case 1:n=t.v,(i=e.contentType)||(s=e.name.split(".").pop().toLowerCase(),i=m(s)||"application/octet-stream"),a.push({id:e.id,name:e.name,contentType:i,size:e.size,contentBytes:n.content,isInline:e.isInline||!1,attachmentType:e.attachmentType});case 2:return t.a(2)}},t)}),i.s();case 3:if((c=i.n()).done){t.n=5;break}return t.d(e(s()),4);case 4:t.n=3;break;case 5:t.n=7;break;case 6:t.p=6,u=t.v,i.e(u);case 7:return t.p=7,i.f(),t.f(7);case 8:return t.a(2,a)}},t,null,[[2,6,7,8]])}))).apply(this,arguments)}function m(t){return{pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",txt:"text/plain",zip:"application/zip",rar:"application/x-rar-compressed"}[t]||null}function y(){return v.apply(this,arguments)}function v(){return(v=c(o().m(function t(){var e,n,r,a,i,c,s,u,f;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=Office.context.mailbox.item,n=e.subject,r=e.from&&e.from.emailAddress?e.from.emailAddress:"",t.n=1,l(e);case 1:return a=t.v,i=e.to&&e.to.length>0?e.to[0].emailAddress:"",t.n=2,p(e);case 2:return c=t.v,s={subject:n,to:i,from:r,body:a,attachments:c},t.p=3,t.n=4,fetch("https://defaulte8fc68b65d194bf4a2c1a5ed5dc4c2.f5.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/147199a4a1cb4dbe98d5119cffa803bd/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=2kLY1Qkb-zgjJuEIpGJBR94VBHYMV-qkPgel0ubfu_U",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 4:(u=t.v).ok?(console.log("Fluxo acionado com sucesso!"),alert("Fluxo iniciado com sucesso!")):(console.error("Erro ao acionar fluxo:",u.statusText),alert("Erro ao acionar fluxo.")),t.n=6;break;case 5:t.p=5,f=t.v,console.error("Falha na requisi√ß√£o:",f),alert("Falha ao conectar ao Power Automate.");case 6:return t.a(2)}},t,null,[[3,5]])}))).apply(this,arguments)}function h(){return b.apply(this,arguments)}function b(){return b=c(o().m(function t(){var e,n,r;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=document.getElementById("folders-list")){t.n=1;break}return console.error("Elemento #folders-list n√£o encontrado no HTML."),t.a(2);case 1:return e.innerHTML="<p>Carregando pastas...</p>",t.p=2,t.n=3,g();case 3:if(0!==(n=t.v).length){t.n=4;break}return e.innerHTML="<p>Nenhuma pasta encontrada.</p>",t.a(2);case 4:e.innerHTML=n.map(function(t){return'\n          <div class="folder-item" data-id="'.concat(t.id,'" \n              style="cursor:pointer; padding:8px; border:1px solid #ddd; margin-bottom:5px; border-radius:5px; display:flex; align-items:center; gap:8px;">\n            \n            <img src="../../assets/folder.png" \n                alt="folder" width="20" height="20" \n                style="pointer-events:none;" />\n\n            <span>').concat(t.nome,"</span>\n          </div>")}).join(""),document.querySelectorAll(".folder-item").forEach(function(t){t.addEventListener("click",function(){var t=c(o().m(function t(e){var n;return o().w(function(t){for(;;)switch(t.n){case 0:S((null===(n=e.target.textContent)||void 0===n?void 0:n.trim())||"");case 1:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}())}),t.n=6;break;case 5:t.p=5,r=t.v,console.error(r),e.innerHTML="<p>Erro ao carregar as pastas.</p>";case 6:return t.a(2)}},t,null,[[2,5]])})),b.apply(this,arguments)}function g(){return w.apply(this,arguments)}function w(){return(w=c(o().m(function t(){var e,n,r;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,fetch("https://defaulte8fc68b65d194bf4a2c1a5ed5dc4c2.f5.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/ed37f3d5436d4e928c3a7680cf95b076/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=jech5xSQ8_ib0EV2vu2JblGA9KP1cOJJGNpBsWM_BRY",{method:"POST"});case 1:if((e=t.v).ok){t.n=2;break}return console.error("Erro ao buscar pastas:",e.statusText),t.a(2,[]);case 2:return t.n=3,e.json();case 3:if(n=t.v,console.log("üîµ RAW RESPONSE DO FLOW:",n),!Array.isArray(n)){t.n=4;break}return console.log("üü¢ Lista de pastas carregada:",n),t.a(2,n);case 4:return console.log("üî¥ Formato inesperado:",n),t.a(2,[]);case 5:return t.p=5,r=t.v,console.error("Falha ao carregar pastas:",r),t.a(2,[])}},t,null,[[0,5]])}))).apply(this,arguments)}function x(t){return E.apply(this,arguments)}function E(){return(E=c(o().m(function t(e){var n,r,a,i,c,s,u,f,d;return o().w(function(t){for(;;)switch(t.n){case 0:return n=Office.context.mailbox.item,t.n=1,p(n);case 1:return r=t.v,i=e,c=n.subject,s=n.from.emailAddress,u=n.to&&n.to.length>0?n.to[0].emailAddress:"",f=r,t.n=2,l(n);case 2:return d=t.v,a={folderName:i,subject:c,from:s,to:u,attachments:f,body:d},t.n=3,fetch("https://defaulte8fc68b65d194bf4a2c1a5ed5dc4c2.f5.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/0a1f02a5fb85469c9c9202ee125a044a/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=g78uUy_e-iG9t-rLhoLAPB40pmt6NHEOI0y_z3sYXUA",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 3:t.v;case 4:return t.a(2)}},t)}))).apply(this,arguments)}function S(t){var e=document.getElementById("confirm-modal");document.getElementById("confirm-text").textContent='Deseja salvar o e-mail na pasta "'.concat(t,'"?'),e.style.display="flex";var n=document.getElementById("btn-confirm-yes"),r=document.getElementById("btn-confirm-no");n.replaceWith(n.cloneNode(!0)),r.replaceWith(r.cloneNode(!0));var a=document.getElementById("btn-confirm-yes"),i=document.getElementById("btn-confirm-no");a.addEventListener("click",c(o().m(function n(){return o().w(function(n){for(;;)switch(n.n){case 0:return e.style.display="none",n.n=1,x(t);case 1:s("E-mail salvo na pasta com sucesso!");case 2:return n.a(2)}},n)}))),i.addEventListener("click",function(){e.style.display="none",s("Cancelado.")})}Office.onReady(function(){var t=c(o().m(function t(e){return o().w(function(t){for(;;)switch(t.n){case 0:if(e.host!==Office.HostType.Outlook){t.n=2;break}return document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=y,t.n=1,u("folders-list");case 1:h();case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}())}(),new URL(n(58394),n.b),new URL(n(98362),n.b),new URL(n(18774),n.b)}();
//# sourceMappingURL=taskpane.js.map